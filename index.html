<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turismo Piombino - Traslados y Viajes</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <style>
        :root { --primary-color: #00796b; --whatsapp-color: #25D366; --whatsapp-hover-color: #1DAE56; }
        html { scroll-behavior: smooth; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        .container { max-width: 1100px; }
        nav { position: sticky; top: 0; z-index: 1000; background-color: var(--pico-card-background-color); border-bottom: 1px solid var(--pico-card-border-color); padding: 0.5rem 1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        nav ul { margin-bottom: 0; }
        nav li a[role="button"] { margin-bottom: 0; padding: 5px 10px; }
        .servicios-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 2rem; }
        .servicio-card { border: 1px solid var(--pico-muted-border-color); border-radius: var(--pico-border-radius); padding: 1.5rem; text-align: center; transition: transform 0.2s, box-shadow 0.2s; display: flex; flex-direction: column; }
        .servicio-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        .servicio-card .icono { font-size: 2.5rem; color: var(--primary-color); margin-bottom: 1rem; }
        .servicio-card p { flex-grow: 1; }
        .servicio-card button { background-color: var(--primary-color); border-color: var(--primary-color); width: 100%; }
        /* Oculta campos específicos por defecto */
        #cotizacion-form-container .campo-especifico { display: none; }
        .punto-recogida { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; }
        .punto-recogida input { flex-grow: 1; }
        .punto-recogida button { width: auto; padding: 0 0.75rem; line-height: 1.5rem; background-color: var(--pico-muted-background-color); color: var(--pico-muted-color); border: 1px solid var(--pico-muted-border-color); }
        footer { margin-top: 4rem; padding: 2rem 1rem; border-top: 1px solid var(--pico-muted-border-color); text-align: center; background-color: var(--pico-muted-background-color); }
        footer a { font-size: 1.5rem; margin: 0 0.5rem; color: var(--pico-secondary); }
        section { padding-top: 5rem; }
    </style>
</head>
<body>
    <nav class="container-fluid">
        <ul><li><strong><a href="#">Turismo Piombino</a></strong></li></ul>
        <ul><li><a href="#servicios">Servicios</a></li><li><a href="#disponibilidad">Disponibilidad</a></li></ul>
    </nav>
    <main class="container">
        <section id="servicios">
            <h2 style="text-align:center;">Nuestros Servicios de Transporte</h2>
            <div class="servicios-grid">
                <article class="servicio-card"><div class="icono"><i class="fa-solid fa-ticket"></i></div><h5>Traslados a Eventos</h5><p>Recitales, festivales y más. Viaja en grupo de forma segura.</p><button onclick="abrirModalCotizacion('Recital')">Cotizar</button></article>
                <article class="servicio-card"><div class="icono"><i class="fa-solid fa-martini-glass-citrus"></i></div><h5>Eventos Sociales</h5><p>Casamientos, cumpleaños y celebraciones.</p><button onclick="abrirModalCotizacion('Evento Social')">Cotizar</button></article>
                <article class="servicio-card"><div class="icono"><i class="fa-solid fa-briefcase"></i></div><h5>Eventos Corporativos</h5><p>Transporte para seminarios, jornadas y team building.</p><button onclick="abrirModalCotizacion('Evento Corporativo')">Cotizar</button></article>
                <article class="servicio-card"><div class="icono"><i class="fa-solid fa-plane-departure"></i></div><h5>Traslados Aeropuerto</h5><p>Viajes a Ezeiza y Aeroparque. Puntualidad y confort.</p><button onclick="abrirModalCotizacion('Aeropuerto')">Cotizar</button></article>
                <article class="servicio-card"><div class="icono"><i class="fa-solid fa-van-shuttle"></i></div><h5>Viajes Privados</h5><p>Alquiler de vehículos con chofer para el destino que necesites.</p><button onclick="abrirModalCotizacion('Viaje Privado')">Cotizar</button></article>
                <article class="servicio-card"><div class="icono"><i class="fa-solid fa-earth-americas"></i></div><h5>Larga Distancia</h5><p>Servicios de larga distancia. Consultá por tu próximo destino.</p><button onclick="abrirModalCotizacion('Larga Distancia')">Cotizar</button></article>
            </div>
        </section>
        <hr>
        <section id="disponibilidad">
            <h2>Disponibilidad General</h2>
            <p>Este calendario muestra los bloques de tiempo ocupados. Si tu fecha está libre, ¡no dudes en consultar!</p>
            <div class="calendar-container" style="position: relative; padding-bottom: 75%; height: 0; overflow: hidden; max-width: 100%;">
                <iframe src="https://calendar.google.com/calendar/embed?src=e7dc2c14d6465b8137e09d3128566ae23a25b3110fc57aee79302fa1990c1552%40group.calendar.google.com&ctz=America%2FArgentina%2FBuenos_Aires" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"></iframe>
            </div>
        </section>
    </main>
    <footer id="contacto">
      <p><strong>Turismo Piombino © 2025</strong></p>
      <p>Seguinos en nuestras redes:</p>
      <a href="https://www.instagram.com/turismo_piombino/" target="_blank" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
      <a href="https://www.facebook.com/leo.piombino" target="_blank" aria-label="Facebook"><i class="fa-brands fa-facebook"></i></a>
    </footer>

    <dialog id="modal-cotizacion">
      <article>
        <header>
          <button aria-label="Close" rel="prev" onclick="document.getElementById('modal-cotizacion').close()"></button>
          <h4 id="modal-titulo">Solicitud de Cotización</h4>
        </header>
        <form id="cotizacion-form-container">
            <input type="hidden" id="form-servicio-tipo" name="tipo_servicio">
            <label>Nombre y Apellido <input type="text" name="nombre_cliente" required></label>
            <label>Teléfono (con cód. de área) <input type="tel" name="telefono" required></label>
            <label>Cantidad Total de Pasajeros <input type="number" name="pasajeros_totales" min="1" required></label>
            
            <div id="campos-aeropuerto" class="campo-especifico">
                <label>Aeropuerto
                    <select name="aeropuerto">
                        <option value="EZE">Ezeiza (EZE)</option>
                        <option value="AEP">Aeroparque (AEP)</option>
                    </select>
                </label>
                <label>Fecha y Hora del Vuelo <input type="datetime-local" name="fecha_hora_vuelo"></label>
            </div>
            <div id="campos-evento-social" class="campo-especifico">
                <label>Fecha del Evento <input type="date" name="fecha_evento"></label>
                <label>Dirección del Evento/Destino <input type="text" name="direccion_evento"></label>
                <label>Tipo de Viaje
                    <select name="tipo_viaje">
                        <option value="Ida y Vuelta">Ida y Vuelta</option>
                        <option value="Solo Ida">Solo Ida</option>
                        <option value="Solo Vuelta">Solo Vuelta</option>
                    </select>
                </label>
                 <label>Horario de Ida (aprox.) <input type="time" name="horario_ida"></label>
                 <label>Horario de Vuelta (aprox.) <input type="time" name="horario_vuelta"></label>
            </div>

            <fieldset>
                <legend>Puntos de Recogida/Partida</legend>
                <div id="puntos-recogida-container">
                    <div class="punto-recogida"><input type="text" name="puntos_de_recogida[]" placeholder="Dirección del primer punto" required></div>
                </div>
                <button type="button" class="secondary" onclick="anadirPuntoRecogida()">+ Añadir otro punto</button>
            </fieldset>

            <label>Detalles Adicionales <textarea name="detalles" placeholder="Aclaraciones, si es necesario esperar, etc."></textarea></label>
            <button type="submit">Contactar por WhatsApp</button>
        </form>
      </article>
    </dialog>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const telefonoPiombino = "5491123757821";
    const scriptCarteroUrl = 'https://script.google.com/macros/s/AKfycbwKpO5eAfa1xR8ITcQo8dCfGWCCq23a1BuC3simU84Orf_o7iGLH4VaxUOO0kZuKwUKxA/exec';
    const modal = document.getElementById('modal-cotizacion');
    const form = document.getElementById('cotizacion-form-container');

    window.abrirModalCotizacion = function(tipoServicio) {
        document.getElementById('modal-titulo').innerText = `Cotización para ${tipoServicio}`;
        form.reset();
        document.getElementById('puntos-recogida-container').innerHTML = '<div class="punto-recogida"><input type="text" name="puntos_de_recogida[]" placeholder="Dirección del primer punto" required></div>';
        form.querySelector('#form-servicio-tipo').value = tipoServicio;

        // Oculta todos los campos específicos
        form.querySelectorAll('.campo-especifico').forEach(el => el.style.display = 'none');

        // Muestra los campos correctos según el tipo de servicio
        if (tipoServicio === 'Aeropuerto') {
            document.getElementById('campos-aeropuerto').style.display = 'block';
        } else if (['Recital', 'Evento Social', 'Evento Corporativo'].includes(tipoServicio)) {
            // Reutilizamos el mismo bloque de campos detallados para todos los eventos
            document.getElementById('campos-evento-social').style.display = 'block';
        }
        
        modal.showModal();
    }

    window.anadirPuntoRecogida = function() {
        const container = document.getElementById('puntos-recogida-container');
        const nuevoPunto = document.createElement('div');
        nuevoPunto.className = 'punto-recogida';
        nuevoPunto.innerHTML = `<input type="text" name="puntos_de_recogida[]" placeholder="Siguiente dirección"><button type="button" onclick="this.parentElement.remove()">-</button>`;
        container.appendChild(nuevoPunto);
    }
    
    form.addEventListener('submit', (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        
        const puntos = Array.from(form.querySelectorAll('input[name="puntos_de_recogida[]"]'))
                            .map(input => input.value.trim()).filter(value => value !== '').join(' | ');
        
        // Preparamos los datos para la planilla y el mensaje
        const dataParaSheet = new FormData();
        let msg = `¡Hola! Quisiera cotizar un servicio de *${formData.get('tipo_servicio')}*.\n`;
        
        // Campos comunes
        dataParaSheet.append('tipo_servicio', formData.get('tipo_servicio'));
        dataParaSheet.append('nombre_cliente', formData.get('nombre_cliente'));
        dataParaSheet.append('telefono', formData.get('telefono'));
        dataParaSheet.append('pasajeros_totales', formData.get('pasajeros_totales'));
        dataParaSheet.append('puntos_de_recogida', puntos);
        dataParaSheet.append('detalles', formData.get('detalles'));
        msg += `- Nombre: ${formData.get('nombre_cliente')}\n` +
               `- Teléfono: ${formData.get('telefono')}\n` +
               `- Pasajeros: ${formData.get('pasajeros_totales')}\n` +
               `- Puntos de Partida: ${puntos.replace(/ \| /g, ', ')}\n`;

        // Campos específicos
        if (['Recital', 'Evento Social', 'Evento Corporativo'].includes(formData.get('tipo_servicio'))) {
            dataParaSheet.append('direccion_evento', formData.get('direccion_evento'));
            dataParaSheet.append('detalles', `Tipo Viaje: ${formData.get('tipo_viaje')}, Horario Ida: ${formData.get('horario_ida')}, Horario Vuelta: ${formData.get('horario_vuelta')}. ` + formData.get('detalles'));
            msg += `- Dirección Evento: ${formData.get('direccion_evento')}\n` +
                   `- Tipo de Viaje: ${formData.get('tipo_viaje')}\n` +
                   `- Horarios: Ida ${formData.get('horario_ida')} / Vuelta ${formData.get('horario_vuelta')}\n`;
        }
        if (formData.get('tipo_servicio') === 'Aeropuerto') {
            dataParaSheet.append('aeropuerto', formData.get('aeropuerto'));
            dataParaSheet.append('fecha_hora_vuelo', formData.get('fecha_hora_vuelo'));
            msg += `- Aeropuerto: ${formData.get('aeropuerto')}\n- Vuelo (Fecha/Hora): ${formData.get('fecha_hora_vuelo')}\n`;
        }
        msg += `- Detalles Adicionales: ${formData.get('detalles')}`;
        
        // Tarea 1: Enviar datos a la planilla
        fetch(scriptCarteroUrl, { method: 'POST', body: dataParaSheet })
            .catch(error => console.error("Error al enviar a la planilla:", error));

        // Tarea 2: Abrir WhatsApp
        window.open(`https://wa.me/${telefonoPiombino}?text=${encodeURIComponent(msg)}`, '_blank');
        modal.close();
    });

    // Esta sección para cargar eventos desde una planilla la dejamos comentada por ahora
    // para enfocarnos en el formulario, pero la estructura sigue aquí.
    /*
    const googleSheetEventosUrl = 'URL_DE_LA_OTRA_PLANILLA_DE_EVENTOS';
    ... (código para fetchAndRenderEvents)
    */
});
</script>
</body>
</html>
